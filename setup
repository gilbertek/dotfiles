
#!/usr/bin/env bash

# Install dotfiles symlinks.
set -e

msg() {
  printf '%b\n' "$1" >&2
}

success() {
  if [ "$ret" -eq '0' ]; then
    msg "\\033[32m[âœ”]\\033[0m ${1}${2}"
  fi
}

DOTFILES="$HOME/dotfiles"

_FILES=(
  bash_profile
  aliases
  functions
  railsrc
  tmux.conf
  tmux-osx.conf
  tmux-linux.conf
  editorconfig
  tern-project
  prettierrc
  eslintrc
  # .pryrc
  # .tigrc
  # .rubocop.yml
)

echo -e "\nCreating dotfile symlinks"

for file in ${_FILES[@]}
do
  filename=".$(basename $file '.symlink')"
  target="$HOME/$filename"

  if [ -e $target ]; then
    echo "$target already exists... Skipping."
  else
    echo "Creating symlink for $file"
    ln -snf $DOTFILES/system/$file $target
  fi
done

# neovim and vim config
echo -e "\nCreating config symlinks"
if [ ! -d $HOME/.config ]; then
  mkdir -p $HOME/.config/{nvim,git}
fi

# for config in $DOTFILES/config/*; do
#   filename="$(basename $config)"
#   target="$HOME/.config/$filename"

#   if [ -e $target ]; then
#     echo "$target already exists... Skipping."
#   else
#     echo "Creating symlink for $config"
#     # ln -s $config $target
#   fi
# done

ln -sfn "$DOTFILES/config/nvim/init.vim" ~/.config/nvim/init.vim

# Git and Hub config
mkdir -p ~/.config/git
ln -sfn "$DOTFILES/config/git/gitconfig" ~/.gitconfig

ret="$?"
success "Dotfiles have been configured! Done! ðŸ¤˜"
